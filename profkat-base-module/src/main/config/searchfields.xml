<?xml version="1.0" encoding="UTF-8"?>
<searchfields xmlns="http://www.mycore.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="http://www.mycore.org/ searchfields.xsd"
              xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	 		  xmlns:mcr="http://www.mycore.org/"
 			  xmlns:mods="http://www.loc.gov/mods/v3"
 	          xmlns:xalan="http://xml.apache.org/xalan"
 	          xmlns:xlink="http://www.w3.org/1999/xlink"
>
  <index id="urn" buildaction="delete" />
  
  <!-- Search in MCRObject metadata -->
  <index id="metadata" buildaction="replace">
  
  <!-- MyCoRe BASIC search fields -->
    <!-- Search in service/structural metadata -->  
    <field name="id"            type="identifier" source="objectMetadata" xpath="/mycoreobject" value="@ID" />
    <field name="objectProject" type="identifier" source="objectMetadata" xpath="/mycoreobject" value="substring-before(@ID,'_')" />
    <field name="objectType"    type="identifier" source="objectMetadata" xpath="/mycoreobject" value="substring-before(substring-after(@ID,'_'),'_')" />
    <field name="link"          type="identifier" source="objectMetadata" xpath="/mycoreobject/descendant::*[@xlink:href]" value="@xlink:href" />
    <field name="parent"        type="identifier" source="objectMetadata" xpath="/mycoreobject/structure/parents/parent" value="@xlink:href" />
    <field name="modified"      type="timestamp"  source="objectMetadata" xpath="/mycoreobject/service/servdates/servdate[@type='modifydate']" value="concat(substring(.,1,10),' ',substring(.,12,8))" sortable="true" />
    <field name="created"       type="timestamp"  source="objectMetadata" xpath="/mycoreobject/service/servdates/servdate[@type='createdate']" value="concat(substring(.,1,10),' ',substring(.,12,8))" sortable="true" />

    <!-- Search in all metadata fields (that have an xml:lang attribute) -->
    <field name="allMeta"       type="text"       source="objectMetadata" xpath="/mycoreobject|/mycoreobject/metadata/*//*" value="text()|@xlink:title|@ID" i18n="editor.search.metadata" />

    <!-- Field for sorting by score -->
    <field name="score" type="decimal" source="searcherHitMetadata" sortable="true" />
    <!-- MyCoRe BASIC search fields - END -->

	<!--  CPR searchfields -->
	<field name="name"               type="name" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.surname/surname | /mycoreobject/metadata/box.firstname/firstname | /mycoreobject/metadata/box.nameaffix/nameaffix" value="text()" addable="true"/>
    <field name="title"              type="name" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.academictitle/academictitle" value="text()"  />
    <field name="institute"          type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.institute/institute" value="text()"  />
    <field name="area"               type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.fieldofstudy/fieldofstudy" value="normalize-space(text())" />
 	<field name="proftype"           type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.professorship/professorship/event" value="normalize-space(text())" />
	<field name="birthplace"         type="name" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.birth/birth/event" value="text()" />
	<field name="deathplace"         type="name" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.death/death/event" value="text()" />
    <field name="confession"         type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.confession/confession" value="normalize-space(text())" />
    <field name="parentprofession"   type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.family/family[@type='father' or @type='mother']" value="normalize-space(./profession)" />
    <field name="biography"          type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.biographic/biographic" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="academicdegree"     type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.academicdegree/academicdegree" value="concat(normalize-space(./text/text()),' ',normalize-space(./event/text()))" />
    <field name="acad_degree_study"     type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.academicdegree/academicdegree[@type='studies']" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="acad_degree_promo"     type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.academicdegree/academicdegree[@type='promotion']" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="acad_degree_habil"     type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.academicdegree/academicdegree[@type='habilitation']" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    
    <field name="otherprofessorship" type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.biographic/biographic[@type='otherprofessorship']" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="adminfunction"      type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.adminfunction/adminfunction" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="otherfunction"      type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.otherfunction/otherfunction" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="membership"         type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.membership/membership" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="award"              type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.award/award" value="concat(normalize-space(./time),' ',normalize-space(./text))" />
    <field name="mainpublication"    type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.mainpublication/mainpublication" value="normalize-space(./text())" />
    <field name="source"             type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.source/source" value="@xlink:title" />
    <field name="reference"          type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.reference/reference" value="@xlink:title" />
    <field name="derivatelabel"      type="text" objects="person" source="objectMetadata" sortable="false" xpath="/mycoreobject/structure/derobjects/derobject" value="@xlink:label" />

    <field name="class_proftypes"  objects="person" type="identifier" source="objectCategory" xpath="/mycoreobject/metadata/box.professorship/professorship/classification" value="@ID" />             
    <field name="class_bkl"        objects="person" type="identifier" source="objectCategory" xpath="/mycoreobject/metadata/box.subjectclass/subjectclass" value="@ID" /> 
    <field name="class_fac"        objects="person" type="identifier" source="objectCategory" xpath="/mycoreobject/metadata/box.faculty/faculty/classification" value="@ID" />  
    <field name="class_type"       objects="person" type="identifier" source="objectCategory" xpath="/mycoreobject/metadata/box.type/type" value="@ID" />
    
    <field name="class_fac_sort"   objects="person" sortable="true" type="identifier" source="objectMetadata" xpath="/mycoreobject/metadata/box.faculty/faculty[last()]/classification" value="concat(@categid, '_',/mycoreobject/@ID)" />

	<field name="rostockdate_ivon" objects="person" type="integer" source="objectMetadata" sortable="true" xpath="/mycoreobject/metadata/box.period/period[1]" value="normalize-space(ivon)" />
    <field name="rostockdate_ibis" objects="person" type="integer" source="objectMetadata" sortable="true" xpath="/mycoreobject/metadata/box.period/period[last()]" value="normalize-space(ibis)" />
    <field name="lifetime_ivon"    objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.birth/birth" value="normalize-space(ivon)" />
    <field name="lifetime_ibis"    objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.death/death" value="normalize-space(ibis)" />
    <field name="fac_ivon"         objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.faculty/faculty[1]" value="normalize-space(ivon)" />
    <field name="fac_ibis"         objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.faculty/faculty[last()]" value="normalize-space(ibis)" />
    <field name="proftype_ivon"    objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.professorship/professorship[1]" value="normalize-space(ivon)" />
    <field name="proftype_ibis"    objects="person" type="integer" source="objectMetadata" sortable="false" xpath="/mycoreobject/metadata/box.professorship/professorship[last()]" value="normalize-space(ibis)" />
 
    <field name="profname"  type="name" source="objectMetadata" sortable="true" objects="person" xpath="/mycoreobject/metadata/box.surname/surname[1]" value="text()" />
    <field name="profsortname"  type="name" source="objectMetadata" sortable="true" objects="person" xpath="/mycoreobject/metadata" value="concat(string(./box.surname/surname[1]),', ',string(./box.firstname/firstname[1]))" addable="true"/>
	<field name="profstates"  objects="person" sortable="true"  type="identifier" source="objectMetadata" xpath="/mycoreobject/metadata/box.status/status"  value="text()" />      

    <field name="pnd"  objects="person" sortable="false"  type="identifier" source="objectMetadata" xpath="/mycoreobject/metadata/box.identifier/identifier[@type='pnd']" value="text()" addable="true"/>


   <!-- this field is used by IndexBrowser -->
   <!-- <field name="profindex"  type="index" source="objectMetadata" sortable="true" objects="person" xpath="/mycoreobject/metadata[./box.type/type/@categid='ro_professor' or ./box.type/type/@categid='bue_professor']/box.surname/surname[1]" value="concat(string(.),', ',string(./../../box.firstname/firstname), ' ', string(./../../box.nameaffix/nameaffix), ', ',string(./../../box.firstname/firstname[2]), ', ',string(./../surname[2]), ', ',string(./../surname[3]))" addable="true"/> -->
   <field name="profindex"  type="index" source="objectMetadata" sortable="true" objects="person" xpath="/mycoreobject/metadata/box.surname/surname[1]" value="concat(string(.),', ',string(./../../box.firstname/firstname), ' ', string(./../../box.nameaffix/nameaffix), ', ',string(./../../box.firstname/firstname[2]), ', ',string(./../surname[2]), ', ',string(./../surname[3]))" addable="true"/>
   
   <field name="classlabel_fac"        objects="person" type="text" source="objectCategory" xpath="/mycoreobject/metadata/box.faculty/faculty/classification" value="label[lang('de')]/@text" />
     
   
   
  </index>

  <!-- Search in MCRFile metadata and content -->  
  <index id="content" buildaction="replace">
  
    <!-- Search in fulltext of pdf and txt files -->
    <field name="content" type="text" source="fileTextContent" objects="http pdf ps txt xml msword95 msword97 msppt rtf odt sxw" />
  
    <!-- Search in technical metadata of files -->
    <field name="fileID"            type="identifier" source="fileMetadata" xpath="file/@id" value="." />
    <field name="DerivateID"        type="identifier" source="fileMetadata" xpath="file/@owner" value="." />
    <field name="fileName"          type="identifier" source="fileMetadata" xpath="file/@name" value="." />
    <field name="filePath"          type="identifier" source="fileMetadata" xpath="file/@path" value="." />
    <field name="fileSize"          type="integer"    source="fileMetadata" xpath="file/@size" value="." />
    <field name="fileExtension"     type="identifier" source="fileMetadata" xpath="file/@extension" value="." />
    <field name="fileContentTypeID" type="identifier" source="fileMetadata" xpath="file/contentTypeID" value="." />
    <field name="fileContentType"   type="text"       source="fileMetadata" xpath="file/@contentType" value="." />
    <field name="fileDateModified"  type="date"       source="fileMetadata" xpath="file/@modified" value="." />
  </index>
</searchfields>
